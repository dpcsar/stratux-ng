<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light dark" />
    <title>Stratux-NG</title>
    <link rel="stylesheet" href="/assets/app.css" />
  </head>
  <body>
    <header class="topbar">
      <button id="btn-more" class="iconbtn" aria-label="Menu" title="Menu">
        <span class="icon">☰</span>
      </button>
      <div class="titleblock">
        <div class="title">Stratux-NG</div>
        <div id="subtitle" class="subtitle"></div>
      </div>
      <span></span>
    </header>

    <main id="content" class="content" role="main">
      <section id="view-attitude" class="view" aria-label="Attitude">
        <h2>Attitude</h2>
        <div class="card">
          <div class="attitude-instrument">
            <div class="attitude-row">
              <canvas id="att-tape-left" class="attitude-side-tape left" aria-label="Ground speed tape" role="img"></canvas>
              <div class="attitude-core">
                <div class="attitude-overlay" aria-hidden="true">
                  <div class="attitude-overlay-col">
                    <div class="attitude-overlay-kv"><span class="muted">PIT</span> <span id="att-pitch"></span></div>
                    <div class="attitude-overlay-kv"><span class="muted">ROL</span> <span id="att-roll"></span></div>
                  </div>
                  <div class="attitude-overlay-col right">
                    <div class="attitude-overlay-kv"><span class="muted">HDG</span> <span id="att-heading"></span></div>
                    <div class="attitude-overlay-kv"><span class="muted">PALT</span> <span id="att-palt"></span></div>
                  </div>
                </div>

                <div class="attitude-overlay-bottom-right" aria-hidden="true">
                  <div class="attitude-overlay-kv"><span class="muted">AHRS</span> <span id="att-valid"></span></div>
                  <div class="attitude-overlay-kv"><span class="muted">GPS</span> <span id="att-gps"></span></div>
                </div>
                <canvas id="att-canvas" class="attitude-canvas" aria-label="Attitude indicator" role="img"></canvas>
              </div>
              <canvas id="att-tape-right" class="attitude-side-tape right" aria-label="GPS altitude tape" role="img"></canvas>
            </div>
          </div>

          <canvas id="att-hdg-tape" class="attitude-tape" aria-label="Heading tape" role="img"></canvas>

          <div class="attitude-controls">
            <button id="btn-att-ahrs-level" type="button" class="secondary">Set Level</button>
            <button id="btn-att-ahrs-zero-drift" type="button" class="secondary">Zero Drift</button>
            <span id="att-ahrs-msg" class="muted"></span>
          </div>
        </div>
      </section>

      <section id="view-radar" class="view" aria-label="Radar">
        <h2>Radar</h2>
        <p class="muted">Coming soon. This area will show nearby traffic relative to ownship.</p>
      </section>

      <section id="view-map" class="view" aria-label="Map">
        <h2>Map</h2>
        <p class="muted">Coming soon. This area will show ownship position and track.</p>
      </section>

      <section id="view-status" class="view" aria-label="Status">
        <h2>Status</h2>
        <div id="status-card" class="card">
          <div class="formrow">
            <label class="control">
              <span>Uptime</span>
              <input id="st-uptime" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Now (UTC)</span>
              <input id="st-now" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Last tick (UTC)</span>
              <input id="st-last-tick" type="text" readonly />
            </label>
          </div>

          <div class="divider"></div>

          <div class="formrow">
            <label class="control">
              <span>GDL90 destination</span>
              <input id="st-gdl90-dest" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Interval</span>
              <input id="st-interval" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Frames sent</span>
              <input id="st-frames" type="text" readonly />
            </label>
          </div>

          <div class="divider"></div>

          <div class="formrow">
            <label class="control">
              <input id="st-sim-scenario" type="checkbox" disabled />
              <span>Scenario enabled</span>
            </label>
          </div>
          <div class="formrow">
            <label class="control">
              <input id="st-sim-traffic" type="checkbox" disabled />
              <span>Sim traffic enabled</span>
            </label>
          </div>
          <div class="formrow">
            <label class="control">
              <input id="st-record" type="checkbox" disabled />
              <span>Recording enabled</span>
            </label>
          </div>
          <div class="formrow">
            <label class="control">
			  <input id="st-replay" type="checkbox" disabled />
			  <span>Replay enabled</span>
			</label>
		  </div>

          <div class="divider"></div>

          <div class="formrow">
            <div class="muted">GPS</div>
          </div>

          <div class="formrow">
            <label class="control">
              <input id="st-gps-enabled" type="checkbox" disabled />
              <span>Enabled</span>
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <input id="st-gps-valid" type="checkbox" disabled />
              <span>Fix valid</span>
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <input id="st-gps-stale" type="checkbox" disabled />
              <span>Fix stale (&gt;3s)</span>
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Fix age (s)</span>
              <input id="st-gps-age" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Source</span>
              <input id="st-gps-source" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Device</span>
              <input id="st-gps-device" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>gpsd addr</span>
              <input id="st-gps-gpsd-addr" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Baud</span>
              <input id="st-gps-baud" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Last fix (UTC)</span>
              <input id="st-gps-last-fix" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Fix quality</span>
              <input id="st-gps-fixq" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Fix mode</span>
              <input id="st-gps-fixmode" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Satellites</span>
              <input id="st-gps-sats" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>HDOP</span>
              <input id="st-gps-hdop" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Horiz acc (m)</span>
              <input id="st-gps-hacc" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Vert acc (m)</span>
              <input id="st-gps-vacc" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Latitude</span>
              <input id="st-gps-lat" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Longitude</span>
              <input id="st-gps-lon" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Altitude (ft)</span>
              <input id="st-gps-alt" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Ground speed (kt)</span>
              <input id="st-gps-ground" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Track (deg)</span>
              <input id="st-gps-track" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Vertical speed (fpm)</span>
              <input id="st-gps-vspeed" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>GPS last error</span>
              <input id="st-gps-error" type="text" readonly />
            </label>
          </div>

          <div class="divider"></div>

          <div class="formrow">
            <div class="muted">Fan</div>
          </div>

          <div class="formrow">
            <label class="control">
              <input id="st-fan-enabled" type="checkbox" disabled />
              <span>Enabled</span>
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>CPU temp (°C)</span>
              <input id="st-fan-cpu-temp" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>PWM duty (%)</span>
              <input id="st-fan-duty" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Fan last error</span>
              <input id="st-fan-error" type="text" readonly />
            </label>
          </div>

          <div class="divider"></div>

          <div class="formrow">
            <div class="muted">AHRS sensors</div>
          </div>

          <div class="formrow">
            <label class="control">
              <input id="st-ahrs-imu-detected" type="checkbox" disabled />
              <span>IMU detected</span>
            </label>
          </div>
          <div class="formrow">
            <label class="control">
              <input id="st-ahrs-imu-working" type="checkbox" disabled />
              <span>IMU working</span>
            </label>
          </div>
          <div class="formrow">
            <label class="control">
              <span>IMU last update (UTC)</span>
              <input id="st-ahrs-imu-updated" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <input id="st-ahrs-baro-detected" type="checkbox" disabled />
              <span>Baro detected</span>
            </label>
          </div>
          <div class="formrow">
            <label class="control">
              <input id="st-ahrs-baro-working" type="checkbox" disabled />
              <span>Baro working</span>
            </label>
          </div>
          <div class="formrow">
            <label class="control">
              <span>Baro last update (UTC)</span>
              <input id="st-ahrs-baro-updated" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>AHRS last error</span>
              <input id="st-ahrs-error" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Orientation set</span>
              <input id="st-ahrs-orientation-set" type="text" readonly />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Forward axis</span>
              <input id="st-ahrs-forward-axis" type="text" readonly />
            </label>
          </div>

        </div>
      </section>

      <section id="view-settings" class="view" aria-label="Settings">
        <h2>Settings</h2>
        <p class="muted">Edits are saved to your YAML config and applied immediately.</p>

        <form id="settings-form" class="card" autocomplete="off">
          <div class="formrow">
            <label class="control">
              <span>GDL90 destination</span>
              <input id="set-gdl90-dest" type="text" placeholder="192.168.10.255:4000" />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Interval (e.g. 1s)</span>
              <input id="set-interval" type="text" placeholder="1s" />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <input id="set-traffic-enable" type="checkbox" />
              <span>Sim traffic enabled</span>
            </label>
          </div>

          <div class="divider"></div>

          <div class="formrow">
            <label class="control">
              <input id="set-scenario-enable" type="checkbox" />
              <span>Scenario simulation enabled</span>
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Scenario path</span>
              <select id="set-scenario-path">
                <option value="">(select a scenario)</option>
              </select>
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <span>Scenario start time (RFC3339 UTC)</span>
              <input id="set-scenario-start" type="text" placeholder="2020-01-01T00:00:00Z" />
            </label>
          </div>

          <div class="formrow">
            <label class="control">
              <input id="set-scenario-loop" type="checkbox" />
              <span>Scenario loop</span>
            </label>
          </div>

          <div class="formactions">
            <button id="btn-save" type="submit" class="primary">Save</button>
            <span id="save-msg" class="muted"></span>
          </div>

          <div class="divider"></div>

          <div class="formrow">
            <div class="muted">AHRS calibration</div>
          </div>

          <div class="formactions">
            <button id="btn-ahrs-level" type="button">Set Level</button>
            <button id="btn-ahrs-zero-drift" type="button">Zero Drift</button>
            <button id="btn-ahrs-orient-forward" type="button">Set Forward (hold so nose-end points up)</button>
            <button id="btn-ahrs-orient-done" type="button">Finish Orientation (hold level, mounted)</button>
          </div>

          <div class="formrow">
            <span id="ahrs-msg" class="muted"></span>
          </div>
        </form>
      </section>

      <section id="view-logs" class="view" aria-label="Logs">
        <h2>Logs</h2>
        <p class="muted">Recent Stratux-NG logs from <a href="/api/logs?format=text">/api/logs</a>.</p>
        <div class="controls card">
          <label class="control">
            <span>Tail</span>
            <select id="logs-tail">
              <option value="200" selected>200 lines</option>
              <option value="500">500 lines</option>
              <option value="2000">2000 lines</option>
            </select>
          </label>
          <div class="formactions">
            <button id="logs-refresh" type="button" class="primary">Refresh</button>
            <span id="logs-meta" class="muted"></span>
          </div>
        </div>
        <pre id="logs-text" class="card">Loading…</pre>
      </section>

      <section id="view-about" class="view" aria-label="About">
        <h2>About</h2>
        <p class="muted">Basic information for now. More details will be added later.</p>
        <div class="card">
          <p class="muted">Raw build/runtime details:</p>
          <p><a href="/api/about">/api/about</a></p>
        </div>
      </section>

    </main>

    <nav class="bottomnav" aria-label="Primary">
      <button class="navbtn" data-view="attitude" aria-label="Attitude">
        <span class="navlabel">Attitude</span>
      </button>
      <button class="navbtn" data-view="radar" aria-label="Radar">
        <span class="navlabel">Radar</span>
      </button>
      <button class="navbtn" data-view="map" aria-label="Map">
        <span class="navlabel">Map</span>
      </button>
    </nav>

    <div id="drawer-backdrop" class="backdrop" hidden></div>
    <aside id="drawer" class="drawer" aria-label="More" hidden>
      <div class="drawer-head">
        <div class="drawer-title">More</div>
        <button id="btn-close" class="iconbtn" aria-label="Close menu" title="Close">✕</button>
      </div>
      <div class="drawer-body">
        <button class="drawer-item drawerbtn" data-view="status" type="button">Status</button>
        <button class="drawer-item drawerbtn" data-view="settings" type="button">Settings</button>
        <button class="drawer-item drawerbtn" data-view="logs" type="button">Logs</button>
        <button class="drawer-item drawerbtn" data-view="about" type="button">About</button>
      </div>
    </aside>

    <script src="/assets/app.js"></script>
  </body>
</html>
